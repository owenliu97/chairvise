{"remainingRequest":"C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\src\\store\\helpers\\pptxDownloader.js","dependencies":[{"path":"C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\src\\store\\helpers\\pptxDownloader.js","mtime":1593238998000},{"path":"C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Liu Ruiping\\Documents\\course-profile-mcomp\\proj\\chairvise3-0-final\\src\\web\\app\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Liu Ruiping\\\\Documents\\\\course-profile-mcomp\\\\proj\\\\chairvise3-0-final\\\\src\\\\web\\\\app\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport PptxGenJs from \"pptxgenjs\";\nimport html2canvas from \"html2canvas\";\nimport { PPTX_TITLE_FONT_SIZE, PPTX_CHART_WIDTH, PPTX_CHART_HEIGHT, PPTX_CHART_MARGIN_LEFT, PPTX_CHART_MARGIN_TOP } from \"@/common/const\";\nvar pptx, mainSlide;\nexport function downloadPPTX(presentationFormName) {\n  pptx = new PptxGenJs();\n  pptx.defineSlideMaster({\n    title: 'MASTER_SLIDE',\n    bkgd: 'FFFFFF',\n    objects: [{\n      'rect': {\n        x: 0.0,\n        y: 5.25,\n        w: '100%',\n        h: 0.4,\n        fill: 'DE8080'\n      }\n    }, {\n      'text': {\n        text: 'Powerpoint generated by ChairVise 3.0',\n        options: {\n          x: 3.25,\n          y: 5.25,\n          w: 5.5,\n          h: 0.4,\n          color: 'FFFFFF',\n          fontSize: 14\n        }\n      }\n    }]\n  });\n  mainSlide = pptx.addSlide({\n    masterName: 'MASTER_SLIDE'\n  });\n\n  var iconPath = require('@/assets/MenuIcon.png');\n\n  mainSlide.addImage({\n    path: iconPath,\n    x: 3,\n    y: 0.75,\n    w: 4.0,\n    h: 2.0\n  });\n  mainSlide.addText(presentationFormName, {\n    x: 1.0,\n    y: 3.5,\n    fontSize: PPTX_TITLE_FONT_SIZE,\n    color: '363636',\n    align: 'center'\n  });\n  return createPPTX(presentationFormName);\n}\n\nfunction getDescription() {\n  var desc = document.getElementById(\"presentation-description\").textContent;\n  mainSlide.addText(desc, {\n    x: 1.0,\n    y: 4.15,\n    fontSize: 14,\n    color: '363636',\n    align: 'center'\n  });\n}\n\nfunction getChart(chartElement) {\n  return html2canvas(chartElement).then(function (element) {\n    var slide = pptx.addSlide({\n      masterName: \"MASTER_SLIDE\"\n    });\n    var imageData = element.toDataURL(\"image/png\");\n    slide.addImage({\n      data: imageData,\n      x: PPTX_CHART_MARGIN_LEFT,\n      y: PPTX_CHART_MARGIN_TOP,\n      w: PPTX_CHART_WIDTH,\n      h: PPTX_CHART_HEIGHT\n    });\n  });\n}\n\nfunction createPPTX(_x) {\n  return _createPPTX.apply(this, arguments);\n}\n\nfunction _createPPTX() {\n  _createPPTX = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(presentationFormName) {\n    var chartElements, i;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return getDescription();\n\n          case 2:\n            chartElements = document.getElementsByClassName(\"presentation-section\");\n            i = 0;\n\n          case 4:\n            if (!(i < chartElements.length)) {\n              _context.next = 10;\n              break;\n            }\n\n            _context.next = 7;\n            return getChart(chartElements[i]);\n\n          case 7:\n            i++;\n            _context.next = 4;\n            break;\n\n          case 10:\n            pptx.writeFile(presentationFormName);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _createPPTX.apply(this, arguments);\n}",{"version":3,"sources":["C:/Users/Liu Ruiping/Documents/course-profile-mcomp/proj/chairvise3-0-final/src/web/app/src/store/helpers/pptxDownloader.js"],"names":["PptxGenJs","html2canvas","PPTX_TITLE_FONT_SIZE","PPTX_CHART_WIDTH","PPTX_CHART_HEIGHT","PPTX_CHART_MARGIN_LEFT","PPTX_CHART_MARGIN_TOP","pptx","mainSlide","downloadPPTX","presentationFormName","defineSlideMaster","title","bkgd","objects","x","y","w","h","fill","text","options","color","fontSize","addSlide","masterName","iconPath","require","addImage","path","addText","align","createPPTX","getDescription","desc","document","getElementById","textContent","getChart","chartElement","then","element","slide","imageData","toDataURL","data","chartElements","getElementsByClassName","i","length","writeFile"],"mappings":"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","sourcesContent":["import PptxGenJs from \"pptxgenjs\";\nimport html2canvas from \"html2canvas\";\nimport {\n  PPTX_TITLE_FONT_SIZE,\n  PPTX_CHART_WIDTH,\n  PPTX_CHART_HEIGHT,\n  PPTX_CHART_MARGIN_LEFT,\n  PPTX_CHART_MARGIN_TOP,\n} from \"@/common/const\";\n\nlet pptx, mainSlide;\n\nexport function downloadPPTX(presentationFormName) {\n    pptx = new PptxGenJs();\n    pptx.defineSlideMaster({\n        title: 'MASTER_SLIDE',\n        bkgd:  'FFFFFF',\n        objects: [\n          { 'rect':  { x: 0.0, y:5.25, w:'100%', h:0.4, fill:'DE8080' } },\n          { 'text':  { text:'Powerpoint generated by ChairVise 3.0', options:{ x:3.25, y:5.25, w:5.5, h:0.4, color: 'FFFFFF',\n                        fontSize: 14 } } }\n        ]\n    });\n    mainSlide = pptx.addSlide({ masterName: 'MASTER_SLIDE' });\n    var iconPath = require('@/assets/MenuIcon.png')\n    mainSlide.addImage({ path: iconPath, x:3, y:0.75, w:4.0, h:2.0 });\n    mainSlide.addText(presentationFormName, { x:1.0, y:3.5, fontSize:PPTX_TITLE_FONT_SIZE, color:'363636',\n                        align:'center' });\n    return createPPTX(presentationFormName);\n}\n\nfunction getDescription() {\n    var desc = document.getElementById(\"presentation-description\").textContent;\n    mainSlide.addText(desc, { x:1.0, y:4.15, fontSize:14, color:'363636', align:'center'  });\n}\n\nfunction getChart(chartElement) {    \n    return html2canvas(chartElement).then(element => {\n      var slide = pptx.addSlide({ masterName: \"MASTER_SLIDE\"});    \n      let imageData = element.toDataURL(\"image/png\");\n      slide.addImage({\n          data: imageData,\n          x: PPTX_CHART_MARGIN_LEFT,\n          y: PPTX_CHART_MARGIN_TOP,\n          w: PPTX_CHART_WIDTH,\n          h: PPTX_CHART_HEIGHT\n      });\n    });\n}\n\nasync function createPPTX(presentationFormName) {\n    await getDescription();\n    let chartElements = document.getElementsByClassName(\"presentation-section\");\n    for (let i = 0; i < chartElements.length; i++) {\n      await getChart(chartElements[i]);\n    }    \n    pptx.writeFile(presentationFormName);\n}"]}]}